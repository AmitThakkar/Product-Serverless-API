{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Parameters": {
    "S3BucketName": {
      "Type": "String",
      "Description": "Bucket Name for Lambda Code"
    },
    "S3BucketKey": {
      "Type": "String",
      "Description": "Bucket Key for Lambda Code"
    }
  },
  "Resources" : {
    "ClassicPetite28" : {
      "Type" : "AWS::DynamoDB::Table",
      "Properties" : {
        "TableName" : "ClassicPetite28",
        "KeySchema" : [
          {
            "AttributeName" : "id",
            "KeyType" : "HASH"
          },
          {
            "AttributeName" : "name",
            "KeyType" : "RANGE"
          }
        ],
        "AttributeDefinitions" : [
          {
            "AttributeName" : "id",
            "AttributeType" : "S"
          },
          {
            "AttributeName" : "name",
            "AttributeType" : "S"
          }
        ],
        "ProvisionedThroughput" : {
          "ReadCapacityUnits" : "5",
          "WriteCapacityUnits" : "5"
        }
      }
    },
    "ClassicPetite32" : {
      "Type" : "AWS::DynamoDB::Table",
      "Properties" : {
        "TableName" : "ClassicPetite32",
        "KeySchema" : [
          {
            "AttributeName" : "id",
            "KeyType" : "HASH"
          },
          {
            "AttributeName" : "name",
            "KeyType" : "RANGE"
          }
        ],
        "AttributeDefinitions" : [
          {
            "AttributeName" : "id",
            "AttributeType" : "S"
          },
          {
            "AttributeName" : "name",
            "AttributeType" : "S"
          }
        ],
        "ProvisionedThroughput" : {
          "ReadCapacityUnits" : "5",
          "WriteCapacityUnits" : "5"
        }
      }
    },
    "Dapper38" : {
      "Type" : "AWS::DynamoDB::Table",
      "Properties" : {
        "TableName" : "Dapper38",
        "KeySchema" : [
          {
            "AttributeName" : "id",
            "KeyType" : "HASH"
          },
          {
            "AttributeName" : "name",
            "KeyType" : "RANGE"
          }
        ],
        "AttributeDefinitions" : [
          {
            "AttributeName" : "id",
            "AttributeType" : "S"
          },
          {
            "AttributeName" : "name",
            "AttributeType" : "S"
          }
        ],
        "ProvisionedThroughput" : {
          "ReadCapacityUnits" : "5",
          "WriteCapacityUnits" : "5"
        }
      }
    },
    "ProductLambdaExecutionRole": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "RoleName": "product-lambda-execution-role",
        "Path": "/",
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ]
        }
      }
    },
    "ProductUpdateLogsPolicy": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyName": "product-lambda-execution-role-policy",
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Action": [
                "logs:*",
                "dynamodb:*"
              ],
              "Resource": "*"
            }
          ]
        },
        "Roles": [
          {
            "Ref": "ProductLambdaExecutionRole"
          }
        ]
      }
    },
    "ListCollectionLambda": {
      "Type" : "AWS::Lambda::Function",
      "Properties" : {
        "Code" : {
          "S3Bucket": {"Ref": "S3BucketName"},
          "S3Key": {"Ref": "S3BucketKey"}
        },
        "Description" : "This Lambda Function returns List Of Collection",
        "Handler" : "src/api/collection/list-collection.handler",
        "Role" :  {
          "Fn::GetAtt": [
            "ProductLambdaExecutionRole",
            "Arn"
          ]
        },
        "Runtime" : "nodejs8.10"
      }
    }
  }
}